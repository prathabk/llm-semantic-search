<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Similarity Techniques Comparison - Semantic Search</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/carousel.css') }}">
    <style>
        .title-slide {
            text-align: center;
            padding: 80px 20px;
        }

        .title-slide h1 {
            font-size: 3em;
            margin-bottom: 16px;
        }

        .title-slide .subtitle {
            font-size: 1.5em;
            color: var(--text-secondary);
            margin-bottom: 40px;
        }

        .title-slide .course-info {
            max-width: 700px;
            margin: 0 auto;
            font-size: 1.125em;
            line-height: 1.8;
        }

        .technique-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 24px 0;
        }

        .technique-badge {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 16px;
            text-align: center;
            transition: all 0.3s;
        }

        .technique-badge:hover {
            border-color: var(--primary);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .technique-icon {
            font-size: 2em;
            margin-bottom: 8px;
        }

        .technique-name {
            font-weight: 600;
            color: var(--text);
            font-size: 0.9em;
        }

        .comparison-container {
            margin: 32px 0;
        }

        .search-box {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .search-input-group {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
        }

        .search-input-group input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1em;
            font-family: inherit;
        }

        .search-input-group input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .search-input-group button {
            padding: 12px 32px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .search-input-group button:hover {
            background: var(--primary-dark);
        }

        .search-input-group button:disabled {
            background: var(--border);
            cursor: not-allowed;
        }

        .example-queries {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .example-query {
            padding: 6px 12px;
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 16px;
            font-size: 0.875em;
            cursor: pointer;
            transition: all 0.2s;
        }

        .example-query:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .results-container {
            display: none;
        }

        .results-container.visible {
            display: block;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 24px;
        }

        .method-result {
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
        }

        .method-result:hover {
            box-shadow: 0 4px 16px var(--shadow);
        }

        .method-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--border);
        }

        .method-name {
            font-weight: 700;
            font-size: 1.1em;
            color: var(--text);
        }

        .method-color-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }

        .top-result {
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 12px;
        }

        .result-score {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .score-bar {
            flex: 1;
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
            margin: 0 12px;
        }

        .score-fill {
            height: 100%;
            background: var(--primary);
            transition: width 0.5s ease;
        }

        .score-value {
            font-weight: 600;
            color: var(--primary);
            font-family: monospace;
        }

        .result-text {
            font-size: 0.9em;
            color: var(--text-secondary);
            line-height: 1.5;
            margin-top: 8px;
        }

        .method-stats {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            background: var(--bg);
            border-radius: 6px;
            font-size: 0.875em;
        }

        .stat-item {
            text-align: center;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.85em;
        }

        .stat-value {
            font-weight: 700;
            color: var(--text);
            font-size: 1.1em;
        }

        .loading-spinner {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
        }

        .spinner {
            border: 3px solid var(--border);
            border-top: 3px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .pros-cons {
            margin-top: 16px;
            font-size: 0.875em;
        }

        .pros-cons-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .pros-list {
            color: #059669;
            margin-bottom: 12px;
        }

        .cons-list {
            color: #dc2626;
        }

        .pros-list li, .cons-list li {
            margin-bottom: 4px;
            line-height: 1.4;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 24px 0;
            font-size: 0.9em;
        }

        .comparison-table th {
            background: var(--primary);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 12px;
            border-bottom: 1px solid var(--border);
        }

        .comparison-table tr:hover {
            background: var(--bg);
        }

        .formula-box {
            background: var(--bg);
            border-left: 4px solid var(--primary);
            padding: 16px;
            margin: 16px 0;
            font-family: monospace;
            font-size: 0.95em;
            border-radius: 4px;
        }

        .documents-list {
            max-height: 300px;
            overflow-y: auto;
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }

        .document-item {
            padding: 8px;
            margin-bottom: 8px;
            background: var(--surface);
            border-radius: 4px;
            font-size: 0.9em;
            color: var(--text-secondary);
        }

        .document-id {
            display: inline-block;
            background: var(--primary);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: 600;
            font-size: 0.85em;
            margin-right: 8px;
        }

        .expand-btn {
            cursor: pointer;
            color: var(--primary);
            text-decoration: underline;
            font-size: 0.875em;
            margin-top: 8px;
            display: inline-block;
        }

        .all-results {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .all-results.expanded {
            max-height: 800px;
        }

        .result-item {
            padding: 8px;
            margin-top: 8px;
            background: var(--bg);
            border-radius: 4px;
            font-size: 0.85em;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: var(--text-secondary);
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="/demo" class="home-link">‚Üê Back to Demos</a>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <div class="carousel-container">
            <div class="carousel-wrapper" id="carouselWrapper">

                <!-- Slide 1: Title -->
                <div class="slide">
                    <div class="slide-content title-slide">
                        <h1>‚öñÔ∏è Similarity Techniques Comparison</h1>
                        <p class="subtitle">Compare Different Semantic Search Approaches</p>
                        <div class="course-info">
                            <p>
                                Not all similarity algorithms are created equal. Each has its strengths, weaknesses,
                                and ideal use cases. In this interactive demo, you'll compare five different techniques
                                side by side to understand which works best for different scenarios.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Slide 2: Overview -->
                <div class="slide">
                    <div class="slide-content">
                        <div class="slide-header">
                            <h2>The Five Techniques We'll Compare</h2>
                            <p class="slide-subtitle">From Simple to Sophisticated</p>
                        </div>

                        <div class="technique-grid">
                            <div class="technique-badge" style="border-color: #ef4444;">
                                <div class="technique-icon">üéØ</div>
                                <div class="technique-name">Jaccard Similarity</div>
                            </div>
                            <div class="technique-badge" style="border-color: #10b981;">
                                <div class="technique-icon">üìê</div>
                                <div class="technique-name">Cosine Similarity</div>
                            </div>
                            <div class="technique-badge" style="border-color: #2563eb;">
                                <div class="technique-icon">‚öñÔ∏è</div>
                                <div class="technique-name">TF-IDF + Cosine</div>
                            </div>
                            <div class="technique-badge" style="border-color: #f59e0b;">
                                <div class="technique-icon">‚úèÔ∏è</div>
                                <div class="technique-name">Levenshtein Distance</div>
                            </div>
                            <div class="technique-badge" style="border-color: #8b5cf6;">
                                <div class="technique-icon">üî§</div>
                                <div class="technique-name">Word Overlap</div>
                            </div>
                        </div>

                        <div class="example-box" style="margin-top: 32px;">
                            <h3>What You'll Learn</h3>
                            <ul style="line-height: 2;">
                                <li><strong>How each technique works</strong> - Mathematical foundations</li>
                                <li><strong>Strengths & weaknesses</strong> - When to use each one</li>
                                <li><strong>Real-world comparison</strong> - See results side by side</li>
                                <li><strong>Performance differences</strong> - Speed vs accuracy tradeoffs</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Slide 3: Jaccard Similarity -->
                <div class="slide">
                    <div class="slide-content">
                        <div class="slide-header">
                            <h2>üéØ Jaccard Similarity</h2>
                            <p class="slide-subtitle">Set-Based Overlap Measurement</p>
                        </div>

                        <p>
                            <strong>Jaccard similarity</strong> measures the overlap between two sets of words.
                            It's the simplest technique, treating documents as sets and ignoring word frequency.
                        </p>

                        <div class="formula-box">
                            <strong>Formula:</strong><br>
                            Jaccard(A, B) = |A ‚à© B| / |A ‚à™ B|<br><br>
                            <span style="color: var(--text-secondary); font-size: 0.9em;">
                                (Intersection size divided by union size)
                            </span>
                        </div>

                        <div class="example-box">
                            <h3>Example</h3>
                            <p><strong>Query:</strong> "quick brown fox"</p>
                            <p><strong>Document:</strong> "the quick brown dog"</p>
                            <p style="margin-top: 12px;">
                                ‚Ä¢ <strong>Intersection:</strong> {quick, brown} = 2 words<br>
                                ‚Ä¢ <strong>Union:</strong> {quick, brown, fox, the, dog} = 5 words<br>
                                ‚Ä¢ <strong>Score:</strong> 2/5 = 0.40
                            </p>
                        </div>

                        <table class="comparison-table">
                            <tr>
                                <th style="width: 30%; border-radius: 8px 0 0 0;">Pros ‚úÖ</th>
                                <th style="border-radius: 0 8px 0 0;">Cons ‚ùå</th>
                            </tr>
                            <tr>
                                <td>Simple and fast</td>
                                <td>Ignores word frequency</td>
                            </tr>
                            <tr>
                                <td>Good for exact matching</td>
                                <td>No semantic understanding</td>
                            </tr>
                            <tr>
                                <td>No parameter tuning</td>
                                <td>Treats all words equally</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- Slide 4: Cosine Similarity -->
                <div class="slide">
                    <div class="slide-content">
                        <div class="slide-header">
                            <h2>üìê Cosine Similarity</h2>
                            <p class="slide-subtitle">Vector Angle Measurement</p>
                        </div>

                        <p>
                            <strong>Cosine similarity</strong> measures the angle between two vectors in multi-dimensional space.
                            It considers word frequency, making it more nuanced than Jaccard.
                        </p>

                        <div class="formula-box">
                            <strong>Formula:</strong><br>
                            cos(Œ∏) = (A ¬∑ B) / (||A|| √ó ||B||)<br><br>
                            <span style="color: var(--text-secondary); font-size: 0.9em;">
                                (Dot product divided by product of magnitudes)
                            </span>
                        </div>

                        <div class="example-box">
                            <h3>Example</h3>
                            <p><strong>Query:</strong> "cat cat dog" ‚Üí Vector: [2, 1]</p>
                            <p><strong>Document:</strong> "cat dog dog" ‚Üí Vector: [1, 2]</p>
                            <p style="margin-top: 12px;">
                                ‚Ä¢ <strong>Dot product:</strong> (2√ó1) + (1√ó2) = 4<br>
                                ‚Ä¢ <strong>Magnitudes:</strong> ‚àö5 √ó ‚àö5 = 5<br>
                                ‚Ä¢ <strong>Score:</strong> 4/5 = 0.80
                            </p>
                        </div>

                        <table class="comparison-table">
                            <tr>
                                <th style="width: 30%; border-radius: 8px 0 0 0;">Pros ‚úÖ</th>
                                <th style="border-radius: 0 8px 0 0;">Cons ‚ùå</th>
                            </tr>
                            <tr>
                                <td>Considers word frequency</td>
                                <td>Still no semantic meaning</td>
                            </tr>
                            <tr>
                                <td>Scale-invariant</td>
                                <td>Misses synonyms</td>
                            </tr>
                            <tr>
                                <td>Industry standard</td>
                                <td>Ignores word order</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- Slide 5: TF-IDF -->
                <div class="slide">
                    <div class="slide-content">
                        <div class="slide-header">
                            <h2>‚öñÔ∏è TF-IDF + Cosine</h2>
                            <p class="slide-subtitle">Weighted Importance Scoring</p>
                        </div>

                        <p>
                            <strong>TF-IDF</strong> (Term Frequency-Inverse Document Frequency) weights words by their
                            importance. Common words like "the" get low scores, while rare distinctive words get high scores.
                        </p>

                        <div class="formula-box">
                            <strong>Formula:</strong><br>
                            TF-IDF(w) = TF(w) √ó IDF(w)<br>
                            IDF(w) = log(N / DF(w))<br><br>
                            <span style="color: var(--text-secondary); font-size: 0.9em;">
                                TF = term frequency, DF = document frequency, N = total documents
                            </span>
                        </div>

                        <div class="example-box">
                            <h3>Example</h3>
                            <p>
                                Word <strong>"the"</strong> appears in all documents ‚Üí Low IDF ‚Üí Low importance<br>
                                Word <strong>"quantum"</strong> appears in 1 document ‚Üí High IDF ‚Üí High importance
                            </p>
                            <p style="margin-top: 12px; color: var(--text-secondary);">
                                TF-IDF emphasizes distinctive terms that help identify relevant documents.
                            </p>
                        </div>

                        <table class="comparison-table">
                            <tr>
                                <th style="width: 30%; border-radius: 8px 0 0 0;">Pros ‚úÖ</th>
                                <th style="border-radius: 0 8px 0 0;">Cons ‚ùå</th>
                            </tr>
                            <tr>
                                <td>Reduces noise from common words</td>
                                <td>Requires full document corpus</td>
                            </tr>
                            <tr>
                                <td>Highlights distinctive terms</td>
                                <td>Computationally expensive</td>
                            </tr>
                            <tr>
                                <td>Search engine standard</td>
                                <td>Still no semantic understanding</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- Slide 6: Levenshtein -->
                <div class="slide">
                    <div class="slide-content">
                        <div class="slide-header">
                            <h2>‚úèÔ∏è Levenshtein Distance</h2>
                            <p class="slide-subtitle">Character-Level Edit Distance</p>
                        </div>

                        <p>
                            <strong>Levenshtein distance</strong> measures how many character-level edits (insertions,
                            deletions, substitutions) are needed to transform one string into another. Great for typos!
                        </p>

                        <div class="formula-box">
                            <strong>Operations:</strong><br>
                            ‚Ä¢ <strong>Insert</strong> a character<br>
                            ‚Ä¢ <strong>Delete</strong> a character<br>
                            ‚Ä¢ <strong>Substitute</strong> a character<br><br>
                            <span style="color: var(--text-secondary); font-size: 0.9em;">
                                Distance = minimum number of operations needed
                            </span>
                        </div>

                        <div class="example-box">
                            <h3>Example</h3>
                            <p><strong>"kitten"</strong> ‚Üí <strong>"sitting"</strong></p>
                            <p style="margin-top: 12px;">
                                1. kitten ‚Üí sitten (substitute k‚Üís)<br>
                                2. sitten ‚Üí sittin (substitute e‚Üíi)<br>
                                3. sittin ‚Üí sitting (insert g)<br>
                                <strong>Distance: 3 edits</strong>
                            </p>
                        </div>

                        <table class="comparison-table">
                            <tr>
                                <th style="width: 30%; border-radius: 8px 0 0 0;">Pros ‚úÖ</th>
                                <th style="border-radius: 0 8px 0 0;">Cons ‚ùå</th>
                            </tr>
                            <tr>
                                <td>Excellent for typos</td>
                                <td>Very slow for long texts</td>
                            </tr>
                            <tr>
                                <td>Character-level precision</td>
                                <td>No semantic meaning</td>
                            </tr>
                            <tr>
                                <td>Fuzzy matching</td>
                                <td>Poor for reworded content</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- Slide 7: Word Overlap -->
                <div class="slide">
                    <div class="slide-content">
                        <div class="slide-header">
                            <h2>üî§ Word Overlap</h2>
                            <p class="slide-subtitle">Simple Matching Ratio</p>
                        </div>

                        <p>
                            <strong>Word overlap</strong> is the simplest possible metric: what fraction of query words
                            appear in the document? It's fast but crude.
                        </p>

                        <div class="formula-box">
                            <strong>Formula:</strong><br>
                            Overlap = |Query ‚à© Document| / |Query|<br><br>
                            <span style="color: var(--text-secondary); font-size: 0.9em;">
                                (Number of matching words / Total query words)
                            </span>
                        </div>

                        <div class="example-box">
                            <h3>Example</h3>
                            <p><strong>Query:</strong> "machine learning python"</p>
                            <p><strong>Document:</strong> "Python is great for machine learning and data science"</p>
                            <p style="margin-top: 12px;">
                                ‚Ä¢ <strong>Matching:</strong> {machine, learning, python} = 3 words<br>
                                ‚Ä¢ <strong>Query size:</strong> 3 words<br>
                                ‚Ä¢ <strong>Score:</strong> 3/3 = 1.00 (perfect match!)
                            </p>
                        </div>

                        <table class="comparison-table">
                            <tr>
                                <th style="width: 30%; border-radius: 8px 0 0 0;">Pros ‚úÖ</th>
                                <th style="border-radius: 0 8px 0 0;">Cons ‚ùå</th>
                            </tr>
                            <tr>
                                <td>Extremely fast</td>
                                <td>Too simplistic</td>
                            </tr>
                            <tr>
                                <td>Easy to understand</td>
                                <td>Ignores document length</td>
                            </tr>
                            <tr>
                                <td>Good baseline</td>
                                <td>No weighting scheme</td>
                            </tr>
                        </table>
                    </div>
                </div>

                <!-- Slide 8: Interactive Comparison -->
                <div class="slide">
                    <div class="slide-content">
                        <div class="slide-header">
                            <h2>üî¨ Interactive Comparison</h2>
                            <p class="slide-subtitle">See All Techniques in Action</p>
                        </div>

                        <div class="comparison-container">
                            <div class="search-box">
                                <div class="search-input-group">
                                    <input type="text" id="queryInput" placeholder="Enter your search query..." value="machine learning">
                                    <button id="compareBtn" onclick="runComparison()">Compare All</button>
                                </div>
                                <div class="example-queries">
                                    <strong style="margin-right: 8px;">Try:</strong>
                                    <span class="example-query" onclick="setQuery('quick brown fox')">quick brown fox</span>
                                    <span class="example-query" onclick="setQuery('machine learning')">machine learning</span>
                                    <span class="example-query" onclick="setQuery('python programming')">python programming</span>
                                    <span class="example-query" onclick="setQuery('sunny weather')">sunny weather</span>
                                </div>
                            </div>

                            <div id="loadingSpinner" class="loading-spinner" style="display: none;">
                                <div class="spinner"></div>
                                <p>Comparing all techniques...</p>
                            </div>

                            <div id="resultsContainer" class="results-container">
                                <div class="results-grid" id="resultsGrid"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Slide 9: Key Takeaways -->
                <div class="slide">
                    <div class="slide-content">
                        <div class="slide-header">
                            <h2>üìö Key Takeaways</h2>
                            <p class="slide-subtitle">Choosing the Right Technique</p>
                        </div>

                        <div class="example-box" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-color: #f59e0b;">
                            <h3 style="margin-top: 0;">üéØ When to Use Each Technique</h3>
                            <p style="line-height: 1.8; margin: 0;">
                                <strong>Jaccard:</strong> Quick keyword matching, duplicate detection<br>
                                <strong>Cosine:</strong> General-purpose similarity, document comparison<br>
                                <strong>TF-IDF:</strong> Search engines, information retrieval<br>
                                <strong>Levenshtein:</strong> Spell checking, typo tolerance<br>
                                <strong>Word Overlap:</strong> Fast filtering, baseline comparison
                            </p>
                        </div>

                        <ul style="font-size: 1.125em; line-height: 2; margin-top: 32px;">
                            <li><strong>No single "best" technique</strong> - Choose based on your use case</li>
                            <li><strong>Traditional methods have limits</strong> - None understand semantics</li>
                            <li><strong>Modern semantic search uses embeddings</strong> - LLM-based vectors capture meaning</li>
                            <li><strong>Combine techniques</strong> - Use multiple methods for better results</li>
                        </ul>

                        <div style="text-align: center; margin-top: 60px;">
                            <a href="/demo" style="text-decoration: none;">
                                <button class="action-btn" style="padding: 16px 32px; font-size: 1.125em;">
                                    ‚Üê Back to Demos
                                </button>
                            </a>
                            <a href="/demo/full" style="text-decoration: none; margin-left: 16px;">
                                <button class="action-btn" style="padding: 16px 32px; font-size: 1.125em; background: var(--primary);">
                                    Try Full Pipeline Demo ‚Üí
                                </button>
                            </a>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Navigation Controls -->
        <div class="carousel-nav">
            <button id="prevBtn" onclick="prevSlide()">‚Üê Previous</button>

            <div class="nav-center">
                <div class="slide-indicators" id="slideIndicators"></div>
                <span class="slide-counter">
                    <span id="currentSlide">1</span> / <span id="totalSlides">9</span>
                </span>
            </div>

            <button id="nextBtn" onclick="nextSlide()">Next ‚Üí</button>
        </div>
    </div>

    <div class="keyboard-hint" id="keyboardHint">
        Use <kbd>‚Üê</kbd> <kbd>‚Üí</kbd> arrow keys to navigate
    </div>

    <script>
        // Carousel State
        let currentSlide = 0;
        const totalSlides = 9;
        const carouselWrapper = document.getElementById('carouselWrapper');
        const progressFill = document.getElementById('progressFill');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');

        // Comparison State
        let currentResults = null;
        let methodInfo = null;

        // Initialize carousel
        function initCarousel() {
            updateSlide();
            createIndicators();
            setTimeout(() => {
                document.getElementById('keyboardHint').style.animation = 'fadeInOut 3s ease-in-out';
            }, 1000);
        }

        // Navigation Functions
        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                currentSlide++;
                updateSlide();
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                currentSlide--;
                updateSlide();
            }
        }

        function goToSlide(index) {
            currentSlide = index;
            updateSlide();
        }

        function updateSlide() {
            const offset = -currentSlide * 100;
            carouselWrapper.style.transform = `translateX(${offset}%)`;

            const progress = ((currentSlide + 1) / totalSlides) * 100;
            progressFill.style.width = `${progress}%`;

            document.getElementById('currentSlide').textContent = currentSlide + 1;

            prevBtn.disabled = currentSlide === 0;
            nextBtn.disabled = currentSlide === totalSlides - 1;

            updateIndicators();
        }

        function createIndicators() {
            const container = document.getElementById('slideIndicators');
            for (let i = 0; i < totalSlides; i++) {
                const indicator = document.createElement('div');
                indicator.className = 'slide-indicator';
                indicator.onclick = () => goToSlide(i);
                container.appendChild(indicator);
            }
            updateIndicators();
        }

        function updateIndicators() {
            const indicators = document.querySelectorAll('.slide-indicator');
            indicators.forEach((indicator, index) => {
                indicator.classList.toggle('active', index === currentSlide);
            });
        }

        // Keyboard Navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') nextSlide();
            if (e.key === 'ArrowLeft') prevSlide();
        });

        // Comparison Functions
        function setQuery(query) {
            document.getElementById('queryInput').value = query;
            runComparison();
        }

        async function runComparison() {
            const query = document.getElementById('queryInput').value.trim();

            if (!query) {
                alert('Please enter a query');
                return;
            }

            // Show loading
            document.getElementById('loadingSpinner').style.display = 'block';
            document.getElementById('resultsContainer').classList.remove('visible');

            try {
                const response = await fetch('/api/compare-techniques', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ query: query })
                });

                const data = await response.json();

                if (data.success) {
                    currentResults = data.results;
                    methodInfo = data.method_info;
                    displayResults(data);
                } else {
                    alert('Error: ' + data.error);
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Failed to run comparison: ' + error.message);
            } finally {
                document.getElementById('loadingSpinner').style.display = 'none';
            }
        }

        function displayResults(data) {
            const resultsGrid = document.getElementById('resultsGrid');
            resultsGrid.innerHTML = '';

            const methods = ['jaccard', 'cosine', 'tfidf', 'levenshtein', 'word_overlap'];

            methods.forEach(method => {
                const info = data.method_info[method];
                const results = data.results[method];
                const topResult = results[0];

                const methodCard = document.createElement('div');
                methodCard.className = 'method-result';
                methodCard.style.borderColor = info.color;

                // Get top 3 results
                const top3 = results.slice(0, 3);
                const hasMoreResults = results.length > 3;

                methodCard.innerHTML = `
                    <div class="method-header">
                        <div class="method-name">
                            <span class="method-color-dot" style="background: ${info.color};"></span>
                            ${info.name}
                        </div>
                    </div>

                    <div class="top-result">
                        <div class="result-score">
                            <span style="font-size: 0.875em; color: var(--text-secondary);">#1</span>
                            <div class="score-bar">
                                <div class="score-fill" style="width: ${(topResult.score * 100)}%; background: ${info.color};"></div>
                            </div>
                            <span class="score-value">${topResult.score.toFixed(3)}</span>
                        </div>
                        <div class="result-text">${topResult.document}</div>
                    </div>

                    ${top3.slice(1).map((result, idx) => `
                        <div class="result-item">
                            <div class="result-score">
                                <span style="font-size: 0.875em; color: var(--text-secondary);">#${idx + 2}</span>
                                <div class="score-bar">
                                    <div class="score-fill" style="width: ${(result.score * 100)}%; background: ${info.color};"></div>
                                </div>
                                <span class="score-value">${result.score.toFixed(3)}</span>
                            </div>
                            <div class="result-text" style="font-size: 0.85em; color: var(--text-secondary);">
                                ${result.document}
                            </div>
                        </div>
                    `).join('')}

                    ${hasMoreResults ? `
                        <div class="expand-btn" onclick="toggleAllResults(this, '${method}')">
                            Show all ${results.length} results ‚ñº
                        </div>
                        <div class="all-results" id="all-${method}">
                            ${results.slice(3).map((result, idx) => `
                                <div class="result-item">
                                    <div class="result-score">
                                        <span style="font-size: 0.875em; color: var(--text-secondary);">#${idx + 4}</span>
                                        <div class="score-bar">
                                            <div class="score-fill" style="width: ${(result.score * 100)}%; background: ${info.color};"></div>
                                        </div>
                                        <span class="score-value">${result.score.toFixed(3)}</span>
                                    </div>
                                    <div class="result-text" style="font-size: 0.85em; color: var(--text-secondary);">
                                        ${result.document}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}

                    <div class="pros-cons">
                        <div class="pros-cons-title" style="color: #059669;">‚úÖ Best for:</div>
                        <div style="font-size: 0.9em; margin-bottom: 12px; color: var(--text-secondary);">
                            ${info.best_for}
                        </div>
                    </div>
                `;

                resultsGrid.appendChild(methodCard);
            });

            document.getElementById('resultsContainer').classList.add('visible');
        }

        function toggleAllResults(btn, method) {
            const allResults = document.getElementById(`all-${method}`);
            allResults.classList.toggle('expanded');

            if (allResults.classList.contains('expanded')) {
                btn.innerHTML = 'Show less ‚ñ≤';
            } else {
                btn.innerHTML = `Show all results ‚ñº`;
            }
        }

        // Initialize
        initCarousel();

        // Auto-run comparison on interactive slide
        document.addEventListener('DOMContentLoaded', () => {
            // Run initial comparison when we reach slide 8
            const observer = new MutationObserver(() => {
                if (currentSlide === 7 && !currentResults) {
                    runComparison();
                }
            });
        });
    </script>
</body>
</html>
